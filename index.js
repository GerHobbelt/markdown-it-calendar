"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),require("./calendar.css");var weeks=["SUN","MON","TUE","WED","THUS","FRI","SAT"],months=["JANUARY","FEBRUARY","MARCH","APRIL","MAY","JUNE","JULY","AUGUST","SEPTEMBER","OCTOBER","NOVEMBER","DECEMBER"],calendarPlugin=function(t,r){function e(t){t=t.trim().split(" ");try{var r=(parseInt(t[0]),parseInt(t[1]));return r<=12&&r>=1}catch(t){return!1}}function n(t){var r=new Date(t.Date.year,t.Date.month,0),e=r.getDate();r.setDate(1);var n,a,i=r.getDay(),s=document.createElement("table");s.className="calendar",n=s.insertRow(),a=n.insertCell(),a.colSpan="7",a.innerHTML=t.Date.year+"-"+months[parseInt(t.Date.month)-1],n=s.insertRow();for(var o=0;o<7;++o)a=n.insertCell(),a.innerHTML=weeks[o];for(var o=0;o<i;++o)o%7==0&&(n=s.insertRow()),a=n.insertCell();for(var o=i;o<e+i;++o){var u=o-i+1;o%7==0&&(n=s.insertRow()),a=n.insertCell(),r.setDate(u),a.innerHTML=u+"<br>",t.Content[r]&&t.Content[r].forEach(function(t){a.innerHTML+=t.title+":"+t.description+"<br>"})}for(var o=e+i;o%7!=0;++o)a=n.insertCell();return s.outerHTML}function a(t,r,e,a,i){return'<div class="markdown-it-calendar">'+n(t[r].info)+"</div>"}function i(t){try{var r=t.year.toString(),e=t.month.toString(),n=(t.date||"").toString(),t=(t.time||"").toString(),a=[e,n,r,t].join(" "),i=Date.parse(a);if(isNaN(i))return!1;var s=new Date(i);if(s.getMonth()===parseInt(e)-1)return s}catch(t){return!1}return!1}function s(t,r,e,n){var a="]"===t[e-1];if(!a)return!1;if(!(a=t.substring(r,r+p.length)===p))return!1;if(!(a=n(t.substring(r+p.length,e-1))))return!1;var i=t.substring(r+p.length,e-1).trim().split(" ");return{year:i[0],month:i[1]}}function o(t,r,e){return t.substring(r,e).trim()==m}function u(t,r,e,n){var a=t.substring(r,e).trim();try{var s=a.match(d),o=Object.assign({},n);return o.date=parseInt(s[1]),i(o)}catch(t){return!1}return!1}function c(t,r,e){var n=t.substring(r,e).trim();try{var a=n.match(g);return{title:a[1],description:a[2]}}catch(t){return!1}return!1}function l(t,r){var e=t.push(r.type,r.tag||"div",r.nesting);return e.markup=r.markup||"",e.block=r.block||!0,e.content=r.content||"","info"in r&&(e.info=r.info),"map"in r&&(e.map=r.map),e}function f(t,r,e,n){var a,i,f=0,d=t.bMarks[r]+t.tShift[r],g=t.eMarks[r],b={Date:{},Content:{}},M=s(t.src,d,g,h);if(M===!1)return!1;if(n)return!0;for(b.Date=M,a=r+1;a<e;++a)if(d=t.bMarks[a]+t.tShift[a],g=t.eMarks[a],event=c(t.src,d,g),i&&event)b.Content[i]=b.Content[i]||[],b.Content[i].push(event);else{var k=u(t.src,d,g,M);if(k)i=k;else if(i=void 0,t.src[d]===m[0]&&o(t.src,d,g)){f=1;break}}return t.line=a+f,l(t,{type:v,nesting:0,markup:p,info:b,map:[r,t.line],content:""}),!0}var v="calendar",p="#["+v+"=",m="#[/"+v+"]",d=/<!--\s*(\d+)\s*-->/,g=/@\[(.*?)\](.*)/;r=r||{};var h=r.validateParam||e;r.render;t.block.ruler.before("fence",v,f,{alt:["paragraph","blockquote","list"]}),t.renderer.rules[v]=a};exports.default=calendarPlugin;